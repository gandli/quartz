---
title: 数表求乘积
draft: false
tags: 
date: 2024-04-27
---

![[Pasted image 20240427154408.png]]
![[Pasted image 20240427154414.png]]
![[Pasted image 20240427154420.png]]
```python
import pytesseract
from PIL import Image, ImageEnhance

# 打开图像文件
img = Image.open("file-easysum/file.jpg")

# 增强图像对比度，使文本更清晰
enhancer = ImageEnhance.Contrast(img)
img_enhanced = enhancer.enhance(1.5)  # 调整对比度的级别

# 调整图像大小并应用阈值过滤器进行二值化处理
img_resized = img_enhanced.resize((1024, 768))
img_binarized = img_resized.convert("L").point(lambda x: 0 if x < 128 else 255, "1")

# 配置 Tesseract 以将图像视为单一块文本
custom_config = r"--oem 3 --psm 6"
text = pytesseract.image_to_string(img_binarized, config=custom_config)

# 替换识别结果中的度数符号为一个空格
text = text.replace("°", " ")
# print(text)


# 处理识别的文本，将其转换为二维数组
def convert_text_to_matrix(text):
    # 根据换行符分割文本为多行
    lines = text.strip().split("\n")

    # 初始化二维数组
    matrix = []
    for line in lines:
        # 过滤掉非数字字符，并以空格分割每一行中的数字
        numbers = line.strip().split()
        # 将字符串中的数字转换为整数列表
        number_list = [int(num) for num in numbers if num.isdigit()]
        # 如果列表非空，则添加到二维数组中
        if number_list:
            matrix.append(number_list)

    return matrix


# 调用函数，将文本转换为二维数组
matrix = convert_text_to_matrix(text)

# 打印转换后的二维数组
print("矩阵：")
for row in matrix:
    print(row)


def find_max_product(matrix, length):
    all_sequences = []

    rows = len(matrix)
    cols = len(matrix[0])

    for i in range(rows):
        for j in range(cols):
            if j + length <= cols:  # 检查水平方向
                all_sequences.append(matrix[i][j : j + length])

            if i + length <= rows:  # 检查垂直方向
                all_sequences.append([matrix[i + k][j] for k in range(length)])

            if i + length <= rows and j + length <= cols:  # 检查主对角线方向
                all_sequences.append([matrix[i + k][j + k] for k in range(length)])

            if i - length + 1 >= 0 and j + length <= cols:  # 检查副对角线方向
                all_sequences.append([matrix[i - k][j + k] for k in range(length)])

    all_products = []
    for sequence in all_sequences:
        product = 1
        for number in sequence:
            product *= number
        all_products.append(product)

    max_product = max(all_products, default=0)
    max_index = all_products.index(max_product)

    return {
        "all_sequences": all_sequences,
        "all_products": all_products,
        "max_product": max_product,
        "index": max_index + 1,
        "sequence": all_sequences[max_index],
    }


result = find_max_product(matrix, 5)
print(f"\n长度为 {5} 的最大乘积分析：")
print("所有序列：")
for seq in result["all_sequences"]:
    print(seq)
print("\n所有乘积：", result["all_products"])
print("\n最大乘积值：", result["max_product"])
print("最大乘积索引：", result["index"])
print("产生最大乘积的序列：", result["sequence"])
print("\nMAX  SUM:", result["max_product"])
print("PassWord:", "".join(sorted("".join(map(str, result["sequence"])))))
```